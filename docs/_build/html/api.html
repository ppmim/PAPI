

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The astromatic Module &mdash; PAPI 1.0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="PAPI 1.0.1 documentation" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="index.html">PAPI 1.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="the-astromatic-module">
<h1>The <tt class="xref py py-mod docutils literal"><span class="pre">astromatic</span></tt> Module<a class="headerlink" href="#the-astromatic-module" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-astromatic.sextractor">
<span id="astromatic"></span><h2>astromatic<a class="headerlink" href="#module-astromatic.sextractor" title="Permalink to this headline">¶</a></h2>
<p>A wrapper for SExtractor</p>
<p>A wrapper for SExtractor, the Source Extractor.
by Laurent Le Guillou
version: 0.1.5 - last modified: 2005-02-14
version: 0.1.6 - last modified: 2011-06-17 by <a class="reference external" href="mailto:jmiguel&#37;&#52;&#48;iaa&#46;es">jmiguel<span>&#64;</span>iaa<span>&#46;</span>es</a></p>
<blockquote>
<div>Substituted popen2.popen4 with subprocess.Popen</div></blockquote>
<p>This wrapper allows you to configure SExtractor, run it and get
back its outputs without the need of editing SExtractor
configuration files. by default, configuration files are created
on-the-fly, and SExtractor is run silently via python.</p>
<p>Tested on SExtractor versions 2.2.1 and 2.3.2.</p>
<p>Example of use:</p>
<hr class="docutils" />
<blockquote>
<div><p>import sextractor</p>
<p># Create a SExtractor instance
sex = sextractor.SExtractor()</p>
<p># Modify the SExtractor configuration
sex.config[&#8216;GAIN&#8217;] = 0.938
sex.config[&#8216;PIXEL_SCALE&#8217;] = .19
sex.config[&#8216;VERBOSE_TYPE&#8217;] = &#8220;FULL&#8221;
sex.config[&#8216;CHECKIMAGE_TYPE&#8217;] = &#8220;BACKGROUND&#8221;</p>
<p># Add a parameter to the parameter list
sex.config[&#8216;PARAMETERS_LIST&#8217;].append(&#8216;FLUX_BEST&#8217;)</p>
<p># Lauch SExtractor on a FITS file
sex.run(&#8220;nf260002.fits&#8221;)</p>
<p># Read the resulting catalog [first method, whole catalog at once]
catalog = sex.catalog()
for star in catalog:</p>
<blockquote>
<div><p>print star[&#8216;FLUX_BEST&#8217;], star[&#8216;FLAGS&#8217;]
if (star[&#8216;FLAGS&#8217;] &amp; sextractor.BLENDED):</p>
<blockquote>
<div>print &#8220;This star is BLENDED&#8221;</div></blockquote>
</div></blockquote>
<p># Read the resulting catalog [second method, whole catalog at once]
catalog_name = sex.config[&#8216;CATALOG_NAME&#8217;]
catalog_f = sextractor.open(catalog_name)
catalog = catalog_f.readlines()
for star in catalog:</p>
<blockquote>
<div><p>print star[&#8216;FLUX_BEST&#8217;], star[&#8216;FLAGS&#8217;]
if (star[&#8216;FLAGS&#8217;] &amp; sextractor.BLENDED):</p>
<blockquote>
<div>print &#8220;This star is BLENDED&#8221;</div></blockquote>
</div></blockquote>
<p>catalog_f.close()</p>
<p># Read the resulting catalog [third method, star by star]
catalog_name = sex.config[&#8216;CATALOG_NAME&#8217;]
catalog_f = sextractor.open(catalog_name)
star = catalog_f.readline()
while star:</p>
<blockquote>
<div><p>print star[&#8216;FLUX_BEST&#8217;], star[&#8216;FLAGS&#8217;]
if (star[&#8216;FLAGS&#8217;] &amp; sextractor.BLENDED):</p>
<blockquote>
<div>print &#8220;This star is BLENDED&#8221;</div></blockquote>
<p>star = catalog_f.readline()</p>
</div></blockquote>
<p>catalog_f.close()</p>
<p># Removing the configuration files, the catalog and
# the check image
sex.clean(config=True, catalog=True, check=True)</p>
</div></blockquote>
<hr class="docutils" />
<dl class="class">
<dt id="astromatic.sextractor.SExtractor">
<em class="property">class </em><tt class="descclassname">astromatic.sextractor.</tt><tt class="descname">SExtractor</tt><a class="reference internal" href="_modules/astromatic/sextractor.html#SExtractor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astromatic.sextractor.SExtractor" title="Permalink to this definition">¶</a></dt>
<dd><p>A wrapper class to transparently use SExtractor.</p>
<dl class="method">
<dt id="astromatic.sextractor.SExtractor.catalog">
<tt class="descname">catalog</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/astromatic/sextractor.html#SExtractor.catalog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astromatic.sextractor.SExtractor.catalog" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the output catalog produced by the last SExtractor run.
Output is a list of dictionaries, with a dictionary for
each star: {&#8216;param1&#8217;: value, &#8216;param2&#8217;: value, ...}.</p>
</dd></dl>

<dl class="method">
<dt id="astromatic.sextractor.SExtractor.clean">
<tt class="descname">clean</tt><big>(</big><em>config=True</em>, <em>catalog=False</em>, <em>check=False</em><big>)</big><a class="reference internal" href="_modules/astromatic/sextractor.html#SExtractor.clean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astromatic.sextractor.SExtractor.clean" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the generated SExtractor files (if any).
If config is True, remove generated configuration files.
If catalog is True, remove the output catalog.
If check is True, remove output check image.</p>
</dd></dl>

<dl class="method">
<dt id="astromatic.sextractor.SExtractor.run">
<tt class="descname">run</tt><big>(</big><em>file</em>, <em>updateconfig=True</em>, <em>clean=False</em>, <em>path=None</em><big>)</big><a class="reference internal" href="_modules/astromatic/sextractor.html#SExtractor.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astromatic.sextractor.SExtractor.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run SExtractor.</p>
<p>If updateconfig is True (default), the configuration
files will be updated before running SExtractor.</p>
<p>If clean is True (default: False), configuration files 
(if any) will be deleted after SExtractor terminates.</p>
</dd></dl>

<dl class="method">
<dt id="astromatic.sextractor.SExtractor.setup">
<tt class="descname">setup</tt><big>(</big><em>path=None</em><big>)</big><a class="reference internal" href="_modules/astromatic/sextractor.html#SExtractor.setup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astromatic.sextractor.SExtractor.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Look for SExtractor program (&#8216;sextractor&#8217;, or &#8216;sex&#8217;).
If a full path is provided, only this path is checked.
Raise a SExtractorException if it failed.
Return program and version if it succeed.</p>
</dd></dl>

<dl class="method">
<dt id="astromatic.sextractor.SExtractor.update_config">
<tt class="descname">update_config</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/astromatic/sextractor.html#SExtractor.update_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astromatic.sextractor.SExtractor.update_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the configuration files according to the current
in-memory SExtractor configuration.</p>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="astromatic.sextractor.SExtractorException">
<em class="property">exception </em><tt class="descclassname">astromatic.sextractor.</tt><tt class="descname">SExtractorException</tt><a class="reference internal" href="_modules/astromatic/sextractor.html#SExtractorException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#astromatic.sextractor.SExtractorException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></tt></p>
</dd></dl>

</div>
</div>
<div class="section" id="the-photo-module">
<h1>The <tt class="xref py py-mod docutils literal"><span class="pre">photo</span></tt> Module<a class="headerlink" href="#the-photo-module" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-photo.photometry">
<span id="photometry"></span><h2>Photometry<a class="headerlink" href="#module-photo.photometry" title="Permalink to this headline">¶</a></h2>
<p>Module to do some photometry functionalities</p>
<dl class="exception">
<dt id="photo.photometry.CmdException">
<em class="property">exception </em><tt class="descclassname">photo.photometry.</tt><tt class="descname">CmdException</tt><a class="reference internal" href="_modules/photo/photometry.html#CmdException"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#photo.photometry.CmdException" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">exceptions.Exception</span></tt></p>
</dd></dl>

<dl class="function">
<dt id="photo.photometry.MAD">
<tt class="descclassname">photo.photometry.</tt><tt class="descname">MAD</tt><big>(</big><em>a</em>, <em>c=0.67449999999999999</em>, <em>axis=0</em><big>)</big><a class="reference internal" href="_modules/photo/photometry.html#MAD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#photo.photometry.MAD" title="Permalink to this definition">¶</a></dt>
<dd><p>Median Absolute Deviation along given axis of an array:</p>
<p>median(abs(a - median(a))) / c</p>
<p>c = 0.6745 is the constant to convert from MAD to std; it is used by
default</p>
</dd></dl>

<dl class="class">
<dt id="photo.photometry.STILTSwrapper">
<em class="property">class </em><tt class="descclassname">photo.photometry.</tt><tt class="descname">STILTSwrapper</tt><big>(</big><em>*a</em>, <em>**k</em><big>)</big><a class="reference internal" href="_modules/photo/photometry.html#STILTSwrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#photo.photometry.STILTSwrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></p>
<p>Make a wrapper to some functionalities of STILTS</p>
<dl class="attribute">
<dt id="photo.photometry.STILTSwrapper.cat_names">
<tt class="descname">cat_names</tt><em class="property"> = {'IRAS': 'iraspsc', 'USNOB1': 'usno_b1', '2MASS': 'fp_psc'}</em><a class="headerlink" href="#photo.photometry.STILTSwrapper.cat_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="photo.photometry.STILTSwrapper.outfmt">
<tt class="descname">outfmt</tt><em class="property"> = {'ascii': 1, 'votable': 3}</em><a class="headerlink" href="#photo.photometry.STILTSwrapper.outfmt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="photo.photometry.STILTSwrapper.runXMatch">
<tt class="descname">runXMatch</tt><big>(</big><em>cat1</em>, <em>cat2</em>, <em>out_filename=None</em>, <em>out_format='votable'</em>, <em>error=2.0</em><big>)</big><a class="reference internal" href="_modules/photo/photometry.html#STILTSwrapper.runXMatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#photo.photometry.STILTSwrapper.runXMatch" title="Permalink to this definition">¶</a></dt>
<dd><p>&#64;summary: do catalogs cross-match</p>
<p>&#64;param cat1,cat2: catalogs for cross-matching</p>
<p>&#64;param err: max. error for finding objects within (arcseconds)</p>
<p>&#64;param out_filename: filename where results will be saved;if absent, 
the location will be a tempfile with a generated name</p>
<p>&#64;param out_format: format of the output generated; current options available are:
- VO Table (XML) (votable) (default)
- SVC (Software handshaking structure) message (svc)
- ASCII table (ascii)</p>
<p>&#64;return: filename where results where saved (VOTABLE, ASCII_TABLE, ...)</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="photo.photometry.catalog_xmatch">
<tt class="descclassname">photo.photometry.</tt><tt class="descname">catalog_xmatch</tt><big>(</big><em>cat1</em>, <em>cat2</em>, <em>out_filename</em>, <em>out_format='votable'</em>, <em>error=2.0</em><big>)</big><a class="reference internal" href="_modules/photo/photometry.html#catalog_xmatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#photo.photometry.catalog_xmatch" title="Permalink to this definition">¶</a></dt>
<dd><p>&#64;summary: do catalogs cross-match</p>
<p>&#64;param cat1,cat2: catalogs for cross-matching
&#64;param err: max. error for finding objects within (arcseconds)
&#64;param out_filename: filename where results will be saved;if absent,</p>
<blockquote>
<div>the location will be a tempfile with a generated name</div></blockquote>
<dl class="docutils">
<dt>&#64;param out_format: format of the output generated; current options available </dt>
<dd><blockquote class="first">
<div>are:</div></blockquote>
<ul class="last simple">
<li>VO Table (XML) (votable) (default)</li>
<li>SVC (Software handshaking structure) message (svc)</li>
<li>ASCII table (ascii)</li>
</ul>
</dd>
</dl>
<p>&#64;return: filename where results where saved (VOTABLE, ASCII_TABLE, ...)</p>
</dd></dl>

<dl class="function">
<dt id="photo.photometry.compute_regresion">
<tt class="descclassname">photo.photometry.</tt><tt class="descname">compute_regresion</tt><big>(</big><em>vo_catalog</em>, <em>column_x</em>, <em>column_y</em>, <em>output_filename='/tmp/linear_fit.pdf'</em><big>)</big><a class="reference internal" href="_modules/photo/photometry.html#compute_regresion"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#photo.photometry.compute_regresion" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>&#64;summary: Compute and Plot the linear regression of two columns of the </dt>
<dd>input vo_catalog</dd>
</dl>
<p>&#64;param column_x: column number for X values of the regression (MAG_AUTO)
&#64;param column_y: column number for Y values of the regression ( 2MASS</p>
<blockquote>
<div>column name for photometric value )</div></blockquote>
<dl class="docutils">
<dt>&#64;return: tuple with linear fit parameters and a Plot showing the fit</dt>
<dd><p class="first">a - intercept 
b - slope of the linear fit
r - estimated error</p>
<p class="last">None if happen some error</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="photo.photometry.doPhotometry">
<tt class="descclassname">photo.photometry.</tt><tt class="descname">doPhotometry</tt><big>(</big><em>input_image</em>, <em>catalog</em>, <em>output_filename</em><big>)</big><a class="reference internal" href="_modules/photo/photometry.html#doPhotometry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#photo.photometry.doPhotometry" title="Permalink to this definition">¶</a></dt>
<dd><p>&#64;summary: Run the rough photometric calibraiton</p>
<p>&#64;param input_image: reduced science image</p>
<p>&#64;param catalog: photometric catalog to compare to</p>
<p>&#64;param output_filename: file where output figure will be saved</p>
</dd></dl>

<dl class="function">
<dt id="photo.photometry.generate_phot_comp_plot">
<tt class="descclassname">photo.photometry.</tt><tt class="descname">generate_phot_comp_plot</tt><big>(</big><em>input_catalog</em>, <em>filter</em>, <em>expt=1.0</em>, <em>out_filename=None</em>, <em>out_format='pdf'</em><big>)</big><a class="reference internal" href="_modules/photo/photometry.html#generate_phot_comp_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#photo.photometry.generate_phot_comp_plot" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>&#64;summary: generate a photometry comparison plot, comparing instrumental magnitude</dt>
<dd>versus 2MASS photometry</dd>
</dl>
<p>&#64;param catalog : VOTABLE catalog  having the photometric values (instrumental and 2MASS);
&#64;param filter : NIR wavelength filter (J,H,K,Z)
&#64;param expt : exposure time of original input image; needed to</p>
<blockquote>
<div>compute the Instrumental Magnitude (Inst_Mag)</div></blockquote>
<dl class="docutils">
<dt>&#64;param out_filename: filename where results will be saved;if absent, </dt>
<dd>the location will be a tempfile with a generated name</dd>
<dt>&#64;param out_format: format of the output generated; current options available are:</dt>
<dd><ul class="first last simple">
<li>&#8216;pdf&#8217; (default)</li>
<li>&#8216;jpg&#8217;</li>
<li>&#8216;gif&#8217;</li>
<li>for more formats, see  <a class="reference external" href="http://www.star.bris.ac.uk/~mbt/stilts/sun256/plot2d-usage.html">http://www.star.bris.ac.uk/~mbt/stilts/sun256/plot2d-usage.html</a></li>
</ul>
</dd>
</dl>
<p>&#64;return: filename where results where saved (VOTABLE, ASCII_TABLE, ...)</p>
<dl class="docutils">
<dt>&#64;note: &gt; stilts tpipe  ifmt=votable cmd=&#8217;addcol MyMag_K &#8220;-2.5*log10(FLUX_BEST/46.0)&#8221;&#8217; omode=out in=/home/panic/SOFTWARE/STILTS/match_double.vot out=match_D_b.vot</dt>
<dd>&gt; stilts plot2d in=match_S_b.vot subsetNS=&#8217;j_k&lt;=1.0 &amp; k_snr&gt;10&#8217; lineNS=LinearRegression xdata=k_m ydata=MyMag_k xlabel=&#8221;2MASS k_m / mag&#8221; ylabel=&#8221;PAPI k_m / mag&#8221;</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="photo.photometry.nanmedian">
<tt class="descclassname">photo.photometry.</tt><tt class="descname">nanmedian</tt><big>(</big><em>arr</em><big>)</big><a class="reference internal" href="_modules/photo/photometry.html#nanmedian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#photo.photometry.nanmedian" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns median ignoring NAN</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">The <tt class="docutils literal"><span class="pre">astromatic</span></tt> Module</a><ul>
<li><a class="reference internal" href="#module-astromatic.sextractor">astromatic</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-photo-module">The <tt class="docutils literal"><span class="pre">photo</span></tt> Module</a><ul>
<li><a class="reference internal" href="#module-photo.photometry">Photometry</a></li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/api.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="index.html">PAPI 1.0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, J.M.Ibanez (IAA-CSIC).
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>