Installation Guide for the OMEGA2000 Pipeline Software
Rene Fassbender (rfassben@mpe.mpg.de) 08.04.04

1) Copy the directory o2k_utilities/pipeline with all subdirectories 
   to a directory of your choice

2) Define the environment variable O2K_UTIL that points to the directory
   /o2k_utilities. The easiest way is to define it in a setup file, so 
   that it is automatically defined. (E.g. in the file .bash_profile:
   O2K_UTIL='/home/rfassben/data1/Doks/MPIA/O2K/o2k_utilities'; 
   export O2K_UTIL)

3) Copy the context file omega2k.ctx to your MIDAS MIDWORK directory.
   Enable the context in your MIDAS session with: set/context omega2k
   (Again, the easiest way is to write this command in your login.prg
   file in the MIDWORK directory.)

Done. The pipeline is ready to go. The pipeline can now be called with
the MIDAS command:

o2k/pipeline (+parameters)

You will get online help with:

o2k/pipeline help



All other predefined commands (o2k/online etc.) will not work on your own
computer since they talk to the Calar Alto hardware, telescope etc.

In case you want to recompile the pipeline, e.g. after changes of internal
parameters, you have to do the following:
- Edit the first line of $O2K_UTIL/pipeline/C_code/makefile and specify your
  local C compiler.
- Recompilation can then be done with: $O2K_UTIL/pipeline/C_code/make


================================================================================


INSTALLATION COMMENTS (02.06.04):

1) Make sure all MIDAS environment variables are set properly. If they are not 
set automatically, you have to do that, i.e. in your .bash_profile:

MID_WORK='/home/rfassben/data1/midwork'; export MID_WORK
MID_INCLUDE="$MIDASHOME/$MIDVERS/incl"; export MID_INCLUDE
MID_LIB="$MIDASHOME/$MIDVERS/lib"; export MID_LIB
MID_MONIT="$MIDASHOME/$MIDVERS/monit"; export MID_MONIT


2) To allow the pipeline to run on a normal machine (LINUX etc), the extensive RAM
requirements should be lowered. This can be done by constraining certain pipeline
parameters in pipe_para.h. Note that recompilation is required after changes were made. 
For normal applications the following parameters should be sufficient:

/* Parameters for SINGLE IMAGE REDUCTION */
#define SKY_FRAMES_MAX 3  	/* maximun allowed number of frames before and after */
			
/* Parameters for SUMMATION PROCESS */
#define N_AVERAGE_MAX 7     	/* maximum allowed number of total frames for median process*/


3) Your flatfield MUST NOT contain any zeros. This can cause system crashes, due to division
by 0, e.g., during sensitivity corrections. 
				
				
4) Minor code changes for better portability took place in the following modules:
-makefile: substitute {} by () and take out unnecessary libraries
-OMEGA_pipeline.c: comment out one error message function that was not recognized by compiler
-elaborate_sum.c: add comment on zeros in flatfields
-subframe_statistics: rename function select()-->select_0(), to avoid confusion with system function
-pipe_para.h: adjust the above parameters for "home usage"
